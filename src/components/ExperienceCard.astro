---
import TerminalText from './TerminalText.astro';
import TechTag from './TechTag.astro';

interface Props {
  company: string;
  role: string;
  period: string;
  location?: string;
  description: string;
  achievements: string[];
  technologies: string[];
  status?: 'current' | 'completed';
}

const { company, role, period, location, description, achievements, technologies, status = 'completed' } = Astro.props;
---

<div class="mb-8 font-mono text-sm">
  <!-- Main entry line -->
  <div class="flex items-start gap-3 mb-3 group cursor-default">
    <span class={`mt-1 flex-shrink-0 ${status === 'current' ? 'status-active' : 'status-inactive'}`}>●</span>
    <div class="flex-1">
      <div class="flex items-baseline gap-3 flex-wrap">
        <span class="text-text-primary font-semibold text-base">{role}</span>
        <span class="text-accent-secondary">@{company}</span>
        {location && <span class="text-text-dim">({location})</span>}
      </div>
    </div>
    <span class="text-text-dim text-xs whitespace-nowrap">{period}</span>
  </div>

  <!-- Indented details -->
  <div class="terminal-indent space-y-3">
    <!-- Description -->
    <TerminalText variant="tree-branch">
      {description}
    </TerminalText>

    <!-- Achievements -->
    {achievements && achievements.length > 0 && (
      <div class="space-y-2 mt-4">
        {achievements.map((achievement, index) => (
          <div class="flex items-start gap-3 text-text-secondary hover:text-text-primary transition-colors">
            <span class="text-accent-success flex-shrink-0 font-bold">
              {index === achievements.length - 1 ? '┖' : '├'}
            </span>
            <span class="leading-relaxed">{achievement}</span>
          </div>
        ))}
      </div>
    )}

    <!-- Technologies -->
    <div class="flex flex-wrap gap-2 mt-5 pt-3 border-t border-terminal-border">
      <span class="text-text-dim mr-1">Stack:</span>
      {technologies.map((tech) => (
        <TechTag>{tech}</TechTag>
      ))}
    </div>
  </div>
</div>
